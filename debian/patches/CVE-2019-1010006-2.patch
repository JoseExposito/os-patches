From e6ed0d4cdb6326e329c8f61f9cc19ff9331cb0ce Mon Sep 17 00:00:00 2001
From: Jason Crain <jcrain@src.gnome.org>
Date: Sat, 2 Dec 2017 20:24:45 -0600
Subject: [PATCH] Remove unused configure check for
 cairo_format_stride_for_width

This function was introduced in cairo version 1.6.  We already require
version 1.10 so this function will always be available.

https://bugzilla.gnome.org/show_bug.cgi?id=788980
---
 backend/tiff/tiff-document.c | 4 ----
 configure.ac                 | 6 ------
 2 files changed, 10 deletions(-)

Index: evince-3.18.2/backend/tiff/tiff-document.c
===================================================================
--- evince-3.18.2.orig/backend/tiff/tiff-document.c
+++ evince-3.18.2/backend/tiff/tiff-document.c
@@ -273,11 +273,7 @@ tiff_document_render (EvDocument      *d
 		return NULL;
 	}
 
-#ifdef HAVE_CAIRO_FORMAT_STRIDE_FOR_WIDTH
 	rowstride = cairo_format_stride_for_width (CAIRO_FORMAT_RGB24, width);
-#else
-	rowstride = width * 4;
-#endif
 	if (rowstride / 4 != width) {
 		g_warning("Overflow while rendering document.");
 		/* overflow, or cairo was changed in an unsupported way */
Index: evince-3.18.2/configure.ac
===================================================================
--- evince-3.18.2.orig/configure.ac
+++ evince-3.18.2/configure.ac
@@ -234,12 +234,6 @@ fi
 BACKEND_LIBTOOL_FLAGS="-module -avoid-version -no-undefined -export-symbols \$(top_srcdir)/backend/backend.symbols"
 AC_SUBST(BACKEND_LIBTOOL_FLAGS)
 
-dnl ===== Check special functions
-evince_save_LIBS=$LIBS
-LIBS="$LIBS $BACKEND_LIBS"
-AC_CHECK_FUNCS(cairo_format_stride_for_width)
-LIBS=$evince_save_LIBS
-
 # ******************
 # GKT+ Unix Printing
 # ******************
