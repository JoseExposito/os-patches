From: Mathieu Trudel-Lapierre <mathieu.trudel-lapierre@canonical.com>
Subject: Set out_icon_name; which is necessary for indicator.

Otherwise one would see mobile data use the last icon applied in the applet.

---
 src/mobile-helpers.c |   18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

Index: b/src/mobile-helpers.c
===================================================================
--- a/src/mobile-helpers.c
+++ b/src/mobile-helpers.c
@@ -120,6 +120,21 @@ mobile_helper_get_quality_icon_name (gui
 }
 
 const char *
+mobile_helper_get_mobile_quality_icon_name (guint32 quality)
+{
+	if (quality > 80)
+		return "gsm-3g-full";
+	else if (quality > 55)
+		return "gsm-3g-high";
+	else if (quality > 30)
+		return "gsm-3g-medium";
+	else if (quality > 5)
+		return "gsm-3g-low";
+	else
+		return "gsm-3g-none";
+}
+
+const char *
 mobile_helper_get_tech_icon_name (guint32 tech)
 {
 	switch (tech) {
@@ -616,6 +631,9 @@ mobile_helper_get_icon (NMDevice *device
 		                                               mb_state,
 		                                               mb_tech,
 		                                               applet);
+		*out_icon_name = mobile_helper_get_mobile_quality_icon_name (quality_valid ?
+		                                                             quality : 0);
+
 		if ((mb_state != MB_STATE_UNKNOWN) && quality_valid) {
 			gboolean roaming = (mb_state == MB_STATE_ROAMING);
 
